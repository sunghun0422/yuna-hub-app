name: Yuna Auto Commit & Summary Notify

on:
  workflow_dispatch:
  push:
    paths:
      - "DB/01_HUB/YeoSi_YunaHub/12/*.pdf"

permissions:
  contents: write

jobs:
  auto-commit:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Commit and Push PDF Updates
        run: |
          git config --global user.name "YunaHub AutoCommit"
          git config --global user.email "auto@yuna-hub.app"
          git add DB/01_HUB/YeoSi_YunaHub/12/*.pdf
          git commit -m "auto_summary_en: Auto-updated PDF summary (test run)" || echo "No changes to commit"
          git push origin dev_v12
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

  notify:
    runs-on: ubuntu-latest
    needs: auto-commit
    steps:
      - name: Send Gmail Notification
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: smtp.gmail.com
          server_port: 465
          secure: true
          username: "godlee0422@gmail.com"
          password: ${{ secrets.GMAIL_APP_PASSWORD }}
          subject: "[YunaHub] âœ… Auto Commit & PDF Summary Updated"
          to: "godlee0422@gmail.com"
          from: "YunaHub Notifier <godlee0422@gmail.com>"
          body: |
            ğŸ‘‹ ì•ˆë…•í•˜ì„¸ìš” í›ˆëŠë‹˜!

            ì•„ë˜ PDF ì—…ë°ì´íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤ âœ…

            ğŸ“ íŒŒì¼ ê²½ë¡œ:
            DB/01_HUB/YeoSi_YunaHub/12/

            ğŸ“… ì‹¤í–‰ ì¼ì‹œ: ${{ github.event.head_commit.timestamp }}
            ğŸ§© ì»¤ë°‹ ë©”ì‹œì§€: ${{ github.event.head_commit.message }}
            ğŸ”— GitHub ë§í¬: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}

            ìë™ìš”ì•½ ë° ì•Œë¦¼ ê¸°ëŠ¥ ì •ìƒ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤ ğŸ’«

            â€” From your YunaHub ğŸª½
